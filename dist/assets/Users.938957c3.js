import{_ as M}from"./Layout.vue_vue_type_script_setup_true_lang.2ce90447.js";import{s as q,f as x,v as U,x as G,y as J,z as K,j as Q,e as I,r as _,o as s,c as u,b as l,a as i,w as c,m as T,d as D,u as W,A as X,p as v,g as A,B as R,C as P,F as C,h as H,t as y}from"./index.9d79e8e3.js";import"./strategio.04befae5.js";const j=q("datagrid",()=>{const r=x(!0),d=x({currentPage:1,lastPage:1}),k=x([]),m=x([]),n=x(!1);return{loading:r,page:d,items:k,selectedItems:m,checkedAll:n}}),Y=r=>{const d=j(),{checkedAll:k,loading:m,selectedItems:n,items:o,page:a}=U(d);async function p(){m.value=!0,o.value=[],n.value=[];const h=await Q.collections.showAll(r,{currentPage:a.value.currentPage,itemsPerPage:15});if(a.value={currentPage:h.data.currentPage,lastPage:h.data.lastPage},h.data.lastPage<a.value.currentPage)return a.value.currentPage=h.data.lastPage,await p();o.value=h.data.items,m.value=!1}return G(()=>a.value.currentPage,()=>p()),J(()=>{o.value.length!==0&&(k.value=n.value.length===o.value.length)}),K(()=>p()),{store:d,refresh:p}},Z={class:"d-flex justify-space-between align-center"},ee={class:"d-flex ms-3"},te=I({__name:"DatagridHeader",props:{breadcrumbItems:null,refresh:null},setup(r){return(d,k)=>{const m=_("v-breadcrumbs"),n=_("v-btn"),o=_("v-tooltip");return s(),u("div",Z,[l(m,{items:r.breadcrumbItems,class:"pa-0",style:{"font-size":"1.4rem"}},null,8,["items"]),i("div",ee,[l(o,{location:"top",text:"Obnovit data",offset:"-5"},{activator:c(({props:a})=>[l(n,T(a,{variant:"plain",icon:"mdi-refresh",size:"small",color:"",onClick:r.refresh}),null,16,["onClick"])]),_:1}),l(o,{location:"top",text:"Upravit kolekci",offset:"-5"},{activator:c(({props:a})=>[l(n,T(a,{variant:"plain",icon:"mdi-cog",size:"small",color:""}),null,16)]),_:1}),l(n,{variant:"tonal","prepend-icon":"mdi-plus",class:"ms-3"},{default:c(()=>[D(" P\u0159idat ")]),_:1})])])}}}),ae=r=>{const d=r.date.split(" "),k=d[1].split("."),[m,n,o]=d[0].split("-"),[a,p,h]=k[0].split(":");return`${o}.${n}.${m} ${a}:${p}:${h}`},le=()=>({toCzDateTime:ae}),ne={style:{width:"90px"}},se={class:"d-flex align-center"},oe=i("th",null,"ID",-1),re=i("th",{class:"text-right"},"Vytvo\u0159eno",-1),ce=i("th",{class:"text-right"},"Upraveno",-1),ie=i("th",{class:"text-right"},null,-1),ue={key:0},de=["href"],me=["href"],_e={key:2},ve={key:1},pe={class:"text-right"},he={class:"text-right"},fe={class:"text-right"},ge=I({__name:"DatagridTable",props:{columns:null,batchActions:null,rowActions:null,routeDetailName:null},setup(r){const d=r,k=W(),m=j(),{checkedAll:n,items:o,selectedItems:a}=U(m),{toCzDateTime:p}=le(),h=X(()=>o.value.map(g=>({...g,createdAt:p(g.createdAt),updatedAt:p(g.updatedAt)})));function z(){a.value=n.value?[]:o.value}function $(g){k.push({name:d.routeDetailName,params:{id:g}})}function f(g,b){return b[g]}return(g,b)=>{const w=_("v-checkbox"),E=_("v-btn"),N=_("v-list-item-title"),B=_("v-list-item"),O=_("v-list"),S=_("v-menu"),F=_("v-chip"),L=_("v-table");return v(o).length?(s(),A(L,{key:0,density:"default",hover:"",class:"mt-5"},{default:c(()=>[i("thead",null,[i("tr",null,[i("th",ne,[i("div",se,[l(w,{onClick:z,modelValue:v(n),"onUpdate:modelValue":b[0]||(b[0]=t=>R(n)?n.value=t:null),color:"primary",class:"d-flex"},null,8,["modelValue"]),l(E,{icon:"mdi-dots-vertical",variant:"plain",size:"small",id:"menu-activator",disabled:v(a).length===0},null,8,["disabled"]),l(S,{activator:"#menu-activator"},{default:c(()=>[l(O,null,{default:c(()=>[(s(!0),u(C,null,P(r.batchActions,(t,e)=>(s(),A(B,{key:e,value:e},{default:c(()=>[l(N,{onClick:t.handler},{default:c(()=>[D(y(t.title)+" ("+y(v(a).length)+"x) ",1)]),_:2},1032,["onClick"])]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])]),oe,(s(!0),u(C,null,P(r.columns,t=>(s(),u("th",{key:t.key,class:"text-left"},y(t.name),1))),128)),re,ce,ie])]),i("tbody",null,[(s(!0),u(C,null,P(v(h),t=>(s(),u("tr",{key:t.id,class:"text-no-wrap"},[i("td",null,[l(w,{modelValue:v(a),"onUpdate:modelValue":b[1]||(b[1]=e=>R(a)?a.value=e:null),value:t,"value-comparator":(e,V)=>e.id===V.id,color:"primary",class:"d-flex"},null,8,["modelValue","value","value-comparator"])]),i("td",null,[l(F,{size:"small",color:"",style:{cursor:"pointer"},onClick:e=>$(t.id)},{default:c(()=>[D(y(t.id),1)]),_:2},1032,["onClick"])]),(s(!0),u(C,null,P(r.columns,e=>(s(),u("td",{key:e.key},[f(e.key,t)?(s(),u("div",ue,[e.type==="email"?(s(),u("a",{key:0,target:"_blank",href:`mailto:${f(e.key,t)}`},y(f(e.key,t)),9,de)):e.type==="phone"?(s(),u("a",{key:1,target:"_blank",href:`tel:${f(e.key,t)}`},y(f(e.key,t)),9,me)):(s(),u("span",_e,y(f(e.key,t)),1))])):(s(),u("div",ve,"-"))]))),128)),i("td",pe,y(t.updatedAt),1),i("td",he,y(t.updatedAt),1),i("td",fe,[l(S,null,{activator:c(({props:e})=>[l(E,T({icon:"mdi-dots-vertical"},e,{size:"small",variant:"plain"}),null,16)]),default:c(()=>[l(O,null,{default:c(()=>[(s(!0),u(C,null,P(r.rowActions,(e,V)=>(s(),A(B,{key:V,value:V},{default:c(()=>[l(N,{onClick:ke=>e.handler(t)},{default:c(()=>[D(y(e.title),1)]),_:2},1032,["onClick"])]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024),l(E,{icon:"mdi-arrow-right",variant:"plain",size:"small",onClick:e=>$(t.id)},null,8,["onClick"])])]))),128))])]),_:1})):H("",!0)}}}),Pe=I({__name:"Users",setup(r){const{store:d,refresh:k}=Y("user"),{items:m,page:n,selectedItems:o,loading:a}=U(d);function p(){console.log(o.value)}function h(f){console.log(f)}function z(){console.log(o.value)}function $(f){console.log(f)}return(f,g)=>{const b=_("v-pagination");return s(),A(M,{loading:v(a)},{default:c(()=>[l(te,{"breadcrumb-items":["U\u017Eivatel\xE9"],refresh:v(k)},null,8,["refresh"]),l(ge,{columns:[{name:"Role",key:"role",type:"string"},{name:"E-mail",key:"email",type:"email"}],"batch-actions":[{title:"Odhl\xE1sit u\u017Eivatele",handler:p},{title:"Trvale odstranit",handler:z}],"row-actions":[{title:"Odhl\xE1sit u\u017Eivatele",handler:h},{title:"Trvale odstranit",handler:$}],"route-detail-name":"UserDetail"},null,8,["batch-actions","row-actions"]),v(m).length?(s(),A(b,{key:0,modelValue:v(n).currentPage,"onUpdate:modelValue":g[0]||(g[0]=w=>v(n).currentPage=w),length:v(n).lastPage,"total-visible":5,class:"mt-5"},null,8,["modelValue","length"])):H("",!0)]),_:1},8,["loading"])}}});export{Pe as default};
